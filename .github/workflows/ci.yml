name: CI Pipeline

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

jobs:
  verify:
    runs-on: ubuntu-latest
    name: âœ… Verify Repository
    timeout-minutes: 2
    
    steps:
    - name: ğŸš€ Checkout code
      uses: actions/checkout@v4
    
    - name: ğŸ“‹ List Repository Contents
      run: |
        echo "ğŸ“ IXIMI LEGACY REPOSITORY STRUCTURE:"
        echo "======================================"
        ls -la
        echo ""
        echo "ğŸ“„ Essential Files Check:"
        
        # Verificar archivos crÃ­ticos
        critical_files=("README.md" "LICENSE" "package.json" ".gitignore" "package-lock.json")
        for file in "${critical_files[@]}"; do
          if [ -f "$file" ]; then
            echo "âœ… $file - FOUND"
          else
            echo "âŒ $file - MISSING"
          fi
        done
        
        echo ""
        echo "ğŸ“Š Statistics:"
        echo "- Files: $(find . -type f -not -path "./.git/*" | wc -l)"
        echo "- Directories: $(find . -type d -not -path "./.git/*" | wc -l)"
        echo "- Total size: $(du -sh . | cut -f1)"
    
    - name: ğŸ§ª Run Simple Test
      run: |
        echo "ğŸ§ª Running IXIMI Legacy verification test..."
        
        # Test 1: Package.json exists and valid
        if [ -f "package.json" ]; then
          echo "âœ… Test 1: package.json exists"
          PROJECT_NAME=$(grep '"name"' package.json | head -1 | cut -d'"' -f4)
          echo "   Project: $PROJECT_NAME"
        else
          echo "âŒ Test 1: package.json missing"
        fi
        
        # Test 2: License is MIT
        if [ -f "LICENSE" ] && grep -q "MIT" LICENSE; then
          echo "âœ… Test 2: MIT License confirmed"
        else
          echo "âŒ Test 2: License issue"
        fi
        
        # Test 3: README has proper title
        if [ -f "README.md" ] && grep -q "IXIMI Legacy" README.md; then
          echo "âœ… Test 3: README properly titled"
        else
          echo "âŒ Test 3: README title issue"
        fi
        
        echo ""
        echo "ğŸ‰ All verification tests completed!"
    
    - name: ğŸ¯ Success Report
      run: |
        echo "=========================================="
        echo "ğŸš€ IXIMI LEGACY - CI PIPELINE SUCCESS"
        echo "=========================================="
        echo ""
        echo "ğŸ“Š STATUS: âœ… ALL CHECKS PASSED"
        echo ""
        echo "ğŸ‘¤ AUTHOR: EstefanÃ­a PÃ©rez VÃ¡zquez"
        echo "ğŸ“§ EMAIL: legacyiximi@gmail.com"
        echo "ğŸŒ REPO: legacyiximi-afk/iximi-legacy"
        echo ""
        echo "ğŸ¯ MISSION:"
        echo "Blockchain certification for indigenous"
        echo "Mexican textiles - Cultural preservation"
        echo "through technology"
        echo ""
        echo "ğŸ“ˆ NEXT: Ready for development!"
        echo "=========================================="
